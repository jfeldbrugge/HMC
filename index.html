<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Job Feldbrugge" />
  <title>Hamiltonian Monte Carlo</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="css/style.css" />
  <link rel = "icon" href = "figures/icon.png" type = "image/x-icon"><br />
  <a href="https://jfeldbrugge.github.io/index.html">Home</a>
  <a href="https://jfeldbrugge.github.io/">Projects and Code</a>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Hamiltonian Monte Carlo</h1>
<p class="author">Job Feldbrugge</p>
</header>
<p>The Hamiltonian or Hybrid Monte Carlo (HMC) method is an elegant way
to sample nontrivial distributions in probability theory based on
physical intuitions. It was developed by algorithm was originally
proposed by Simon Duane, Anthony Kennedy, Brian Pendleton and Duncan
Roweth in 1987 for calculations in lattice quantum chromodynamic (see
the
<a href="https://www.sciencedirect.com/science/article/pii/037026938791197X?via%3Dihub">
paper</a>). These notes serve as a brief introduction to the core of the
HMC method for sampling distributions, inspired by the
<a href="https://arxiv.org/abs/1701.02434">review</a> “A Conceptual
Introduction to Hamiltonian Monte Carlo” by Michael Betancourt.</p>
<p>The sampling of classical probability distribution – including the
uniform, the Poisson and Gaussian distributions – are nowadays
implemented in most programming languages. However, one often encounters
more intricate distributions that one may want to sample. In these
cases, Monte Carlo methods shine, allowing one to transform samples from
the classical distributions into samples of the target distribution
<span class="math inline">\(\pi(q)\)</span>. The Hamiltonian Monte Carlo
method is an efficient implementation of this idea borrowing insights
form Hamiltonian dynamics in physics.</p>
<p><strong>The Metropolis-Hastings Algorithm</strong> consists of a
conceptual procedure to sample a target distribution <span
class="math inline">\(\pi\)</span>. The algorithm consists of two steps.
First, starting from the sample <span class="math inline">\(q\)</span>,
we obtain the candidate <span class="math inline">\(q&#39;\)</span>.
Next, we evaluate the acceptance probability <span
class="math inline">\(a(q&#39;|q)\)</span> and check whether this number
lies above a sample from a uniform distribution on the domain <span
class="math inline">\([0,1]\)</span>. If the candidate is accepted, we
repeat this process from <span class="math inline">\(q&#39;\)</span>. If
the candidate is rejected, we start the process over from <span
class="math inline">\(q\)</span>.</p>
<p>Let’s assume we have a sample <span class="math inline">\(q\)</span>
and design a procedure to generate a candidate sample <span
class="math inline">\(q&#39;,\)</span> where the transition probability
of <span class="math inline">\(q&#39;\)</span> conditioned on <span
class="math inline">\(q\)</span> is given by <span
class="math inline">\(\mathbb{Q}(q|q&#39;)\)</span>. The candidate <span
class="math inline">\(q&#39;\)</span> is accepted with probability</p>
<p><span class="math display">\[a(q&#39;|q) = \text{min}\left(1,
\frac{\mathbb{Q}(q|q&#39;)
\pi(q&#39;)}{\mathbb{Q}(q&#39;|q)\pi(q)}\right)\,,\]</span></p>
<p>The Metropolis-Hastings algorithm is an implementation of detailed
balance, where the transition to go from <span
class="math inline">\(q\)</span> to <span
class="math inline">\(q&#39;\)</span> is reversible, satisfying the
equation</p>
<p><span class="math display">\[\mathbb{Q}(q&#39;|q)\pi(q) =
\mathbb{Q}(q|q&#39;)\pi(q&#39;)\,.\]</span></p>
<p>Traditionally, the candidate sample was obtained by performing a
random walk, defined by the transition probability</p>
<p><span class="math display">\[\mathbb{Q}(q&#39;|q) =
\mathcal{N}(q&#39;|q,\Sigma)\,,\]</span></p>
<p>with the normal distribution <span
class="math inline">\(\mathcal{N}(x|\mu,\Sigma)\)</span> defined by the
mean <span class="math inline">\(\mu\)</span> covariance matrix <span
class="math inline">\(\Sigma\)</span>. When the transition probability
<span class="math inline">\(\mathbb{Q}(q&#39;|q)\)</span> is symmetric,
we find that the acceptance probability is independent of the mechanism
with which we obtained the candidate <span
class="math inline">\(q\)</span>’, <em>i.e.</em>,</p>
<p><span class="math display">\[a(q&#39;|q) = \text{min}\left(1,
\frac{\pi(q&#39;)}{\pi(q)}\right)\,.\]</span></p>
<p><strong>The Hamiltonian Monte Carlo algorithm</strong> is a specific
method to find candidate samples <span
class="math inline">\(q&#39;\)</span> given the sample <span
class="math inline">\(q\)</span>, taking the target distribution into
account to improving the acceptance probability. In Hamiltonian Monte
Carlo, we interpret the variable <span class="math inline">\(q\)</span>
as the position of a non-relativistic particle. We introduce an
auxiliary variable <span class="math inline">\(p\)</span> that we will
associate with the momentum of this particle. On phase-space, consisting
of the pair <span class="math inline">\((q,p)\)</span>, we define the
probability distribution</p>
<p><span class="math display">\[\pi(q,p) = \pi(p|q)\pi(q)\]</span></p>
<p>where the conditional probability <span
class="math inline">\(\pi(p|q)\)</span> will be selected below to make
contact with Hamiltonian dynamics.</p>
</body>
</html>
